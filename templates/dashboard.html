<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Font Awesome CDN -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f7fb;
        }

        /* Header Styling */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #B0E992; /* Light Green */
            padding: 20px 40px;
            position: relative;
        }

        /* Logo Container (for logo and store name) */
        .logo-container {
            display: flex;
            align-items: center;
            position: relative;
        }

        /* Image (Logo) Styling */
        .logo-image {
            width: 50px; /* Adjust the size */
            height: 50px; /* Adjust the size */
            object-fit: cover;
            border-radius: 50%; /* Circular shape */
            transition: transform 0.3s ease, box-shadow 0.3s ease; /* Fancy hover effect */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Shadow effect */
            margin-right: 10px;
        }

        .logo-image:hover {
            transform: scale(1.1); /* Slightly enlarge on hover */
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3); /* Enhance shadow on hover */
        }

        /* Store Name Styling */
        .store-name {
            font-size: 1.8rem;
            color: white;
            font-weight: bold;
            font-family: 'Roboto', sans-serif;
            letter-spacing: 2px; /* Slightly increased spacing for a more modern look */
            text-transform: uppercase;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2); /* Add some text shadow */
        }


        /* Horizontal Navigation Bar */
        .navbar {
            background-color: #EFC257; /* Light Orange */
            padding: 10px 40px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin-bottom: 30px;
        }

        .navbar a {
            color: white;
            text-decoration: none;
            font-size: 1.2rem;
            margin: 0 20px;
            transition: color 0.3s ease;
        }

        .navbar a:hover {
            color: #1abc9c;
        }

        /* Main Content */
        .main-content {
            padding: 40px;
            text-align: center;
        }

        .main-content h2 {
            font-size: 2rem;
            color: #2c3e50;
        }

        /* Fullscreen Image and Hover Effects */
        .about-section {
            position: relative;
            width: 100%;
            height: 500px; /* Set a fixed height for the sections */
            margin-bottom: 30px;
            overflow: hidden; /* Ensure nothing overflows when hovered */
        }

        .about-section .image-box {
            position: relative;
            width: 100%;
            height: 100%;
            cursor: pointer;
            transition: transform 0.3s ease; /* Add a scaling effect when hovered */
        }

        .about-section .image-box:hover {
            transform: scale(1.05); /* Slight zoom effect for image */
        }

        .about-section .image-box img {
            width: 100%;
            height: 100%;
            object-fit: cover; /* Make sure the image covers the full box */
            transition: opacity 0.3s ease;
        }

        .about-section .image-info {
            display: none;
            position: absolute;
            top: 50%; /* Center text vertically */
            right: 10%;
            transform: translateY(-50%);
            color: white;
            font-size: 1.4rem; /* Increased font size */
            font-style: italic;
            z-index: 5;
            max-width: 40%;
            text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.7); /* Add subtle shadow for better contrast */
            opacity: 0; /* Start with hidden text */
            transition: opacity 0.3s ease, transform 0.3s ease; /* Smooth transition */
            transform: translateY(-50%) translateX(10px); /* Start slightly offset to the right */
        }

        .about-section .image-box:hover .image-info {
            display: block;
            opacity: 1; /* Show text on hover */
            transform: translateY(-50%) translateX(0px); /* Smooth transition to center */
        }

        .about-section .image-info h3 {
            font-size: 2rem; /* Larger heading for more impact */
            margin-bottom: 15px;
            color: #000; /* Black color for headings */
            font-weight: bold; /* Bold text for heading */
            text-transform: uppercase; /* Make it all caps for added emphasis */
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.5); /* Stronger shadow for readability */
            transition: color 0.3s ease; /* Smooth transition for color change */
        }

        .about-section .image-info h3:hover {
            color: #e67e22; /* Change to a fancy orange color on hover */
        }

        .about-section .image-info p {
            font-size: 1.1rem;
            color: white; /* White color for the paragraph text */
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5); /* Slight shadow for better readability */
            line-height: 1.6; /* Improve line spacing for readability */
            opacity: 0.8; /* Slight transparency for the text */
            transition: opacity 0.3s ease, transform 0.3s ease; /* Smooth transition for effects */
        }

        .about-section .image-info p:hover {
            opacity: 1; /* Make the paragraph fully visible on hover */
            transform: translateY(5px); /* Slight downward movement for emphasis */
        }

        .about-section .image-info h3, .about-section .image-info p {
            transition: transform 0.3s ease, opacity 0.3s ease; /* Smooth animations for both */
        }

        /* Add a border or highlight effect */
        .about-section .image-info:hover {
            border: 2px solid #e67e22; /* Add a glowing border on hover */
            padding: 20px; /* Slightly increase padding on hover */
        }






        /* Profile Avatar (Fixed on the right side) */
        .profile-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #3498db;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 10px;
            cursor: pointer;
            position: fixed;
            top: 20px; /* Position at the top */
            right: 20px; /* Position at the right */
            z-index: 10;
        }

        .profile-avatar img {
            border-radius: 50%;
            width: 50px;
            height: 50px;
        }
        .alert-container {
        margin-top: 20px;
        padding: 10px;
        text-align: center;
    }

    .alert {
        font-size: 1rem;
        margin-bottom: 10px;
    }

    /* Red color alert for error messages */
    .alert-danger {
        background-color: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
        animation: flashAlert 1s linear infinite;
    }

    /* Flashing effect */
    @keyframes flashAlert {
        0% { opacity: 1; }
        50% { opacity: 0.5; }
        100% { opacity: 1; }
    }

    /* Adjust other alerts (info, success, etc.) */
    .alert-success {
        background-color: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
    }

    .alert-info {
        background-color: #d1ecf1;
        color: #0c5460;
        border: 1px solid #bee5eb;
    }

    .alert-warning {
        background-color: #fff3cd;
        color: #856404;
        border: 1px solid #ffeeba;
    }
         /* Floating Copilot Button */
        #copilot-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: transparent;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        #copilot-btn svg {
              width: 50px;  /* Larger icon size */
              height: 50px;
            }


            #copilot-btn:hover::after {
          content: "Ask Narada a Question..?";  /* Hover text */
          position: absolute;
          top: -40px;  /* Position the text above the button */
          left: -40%;  /* Center horizontally */
          transform: translateX(-50%);  /* Align the text to the center */
          background-color: #333;
          color: white;
          padding: 5px 10px;
          font-size: 14px;
          border-radius: 5px;
          opacity: 0.8;
          white-space: nowrap;  /* Prevent the text from wrapping */
        }


        /* Chat Window */
        #chat-window {
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 300px;
            height: 400px;
            background-color: white;
            border: 1px solid #ccc;
            border-radius: 10px;
            display: none;
            flex-direction: column;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        /* Chat Header */
        #chat-header {
            background-color: #4caf50;
            color: white;
            padding: 10px;
            font-size: 16px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: move;
        }

        /* Resize Options */
        #resize-options {
            display: flex;
            gap: 5px;
        }

        .resize-btn {
            background-color: transparent;
            border: none;
            color: white;
            font-size: 14px;
            cursor: pointer;
        }

        /* Chat Content */
        #chat-content {
            flex: 1;
            padding: 10px;
            overflow-y: auto;
            font-size: 14px;
            background-color: #f9f9f9;
        }

        .message {
            margin: 5px 0;
            padding: 8px 12px;
            border-radius: 8px;
            max-width: 80%;
            word-wrap: break-word;
        }

        .user-message {
            background-color: #d1ffd7;
            align-self: flex-end;
        }

        .bot-message {
            background-color: #f1f1f1;
            align-self: flex-start;
        }

        /* Chat Footer */
        .chat-footer {
            display: flex;
            padding: 10px;
            background-color: #f1f1f1;
            border-top: 1px solid #ccc;
        }

        .chat-footer input {
            flex: 1;
            padding: 8px;
            font-size: 14px;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin-right: 10px;
        }

        .chat-footer button {
            background-color: #4caf50;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
        }
        .chatbot-container {
          width: 100%;
          height: 100%;
          max-width: 500px; /* Set a max width to prevent the chatbot from becoming too large */
          max-height: 600px; /* Set a max height if necessary */
          min-width: 300px; /* Set a min width */
          min-height: 400px; /* Set a min height */
          resize: both; /* Allow resizing */
          overflow: auto; /* Add scrollbars if content exceeds the size */
          border: 1px solid #ddd;
          background-color: #fff;
        }

        @media screen and (max-width: 768px) {
          .chatbot-container {
            width: 100%;
            height: 100%;
            min-width: 250px; /* Adjust the min width for smaller screens */
            min-height: 350px; /* Adjust the min height for smaller screens */
          }
        }`


    </style>
</head>
<body>

    <!-- Header with Praveen Store -->
    <header>
        <!-- Background image as logo -->
        <div class="logo-container">
            <img src="{{ url_for('static', filename='images/rice_yield.jpg') }}" alt="Rice Yield Logo" class="logo-image">
            <h1 class="store-name">Praveen Store</h1>
        </div>
        <a href="{{ url_for('profile') }}" class="profile-avatar">
            <img src="{{ url_for('static', filename='uploads/' + user['profile_picture']) }}" alt="Profile Picture">
        </a>
    </header>

        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="alert-container">
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}


    <!-- Horizontal Navigation Bar -->
    <div class="navbar">
        <a href="{{ url_for('home') }}">Home</a>
        <a href="{{ url_for('products') }}">Products</a>
        <a href="{{ url_for('blog_page') }}">Blogs</a>
    </div>

    <!-- Main Content Section -->
    <div class="main-content">
        <h2>Welcome to Praveen Store</h2>
        <p>Your one-stop solution for agricultural products and services.</p>


        <!-- About Section -->
        <div class="about-section">
            <div class="image-box">
                <img src="{{ url_for('static', filename='images/agri1.jpg') }}" alt="Agriculture Image 1">
                <div class="image-info">
                    <h3>About Agriculture</h3>
                    <p>Agriculture is the backbone of the economy, providing food, fiber, and raw materials to people worldwide. With modern technologies, sustainable farming practices, and a focus on organic methods, we are bringing a fresh perspective to agriculture.</p>
                    <p>Organic farming focuses on soil health, sustainable practices, and producing crops without harmful pesticides or chemicals, ensuring a safer environment and healthier food.</p>
                </div>
            </div>
        </div>

        <!-- Additional Information -->
        <div class="about-section">
            <div class="image-box">
                <img src="{{ url_for('static', filename='images/agri2.jpg') }}" alt="Agriculture Image 2">
                <div class="image-info">
                    <h3>Organic Farming</h3>
                    <p>Organic farming not only protects the environment but also boosts biodiversity, improves soil health, and offers nutritious produce. Our commitment to organic farming means we are nurturing the land for future generations.</p>
                </div>
            </div>
        </div>
        <!-- Floating Copilot Button -->
            <button id="copilot-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><g fill="none"><path fill="#212121" d="M7.5 18A3.5 3.5 0 0 0 4 21.5v.5c0 2.393 1.523 4.417 3.685 5.793C9.859 29.177 12.802 30 16 30s6.14-.823 8.315-2.206C26.477 26.418 28 24.394 28 22v-.5a3.5 3.5 0 0 0-3.5-3.5z"/><path fill="url(#fluentColorPerson320)" d="M7.5 18A3.5 3.5 0 0 0 4 21.5v.5c0 2.393 1.523 4.417 3.685 5.793C9.859 29.177 12.802 30 16 30s6.14-.823 8.315-2.206C26.477 26.418 28 24.394 28 22v-.5a3.5 3.5 0 0 0-3.5-3.5z"/><path fill="url(#fluentColorPerson321)" d="M7.5 18A3.5 3.5 0 0 0 4 21.5v.5c0 2.393 1.523 4.417 3.685 5.793C9.859 29.177 12.802 30 16 30s6.14-.823 8.315-2.206C26.477 26.418 28 24.394 28 22v-.5a3.5 3.5 0 0 0-3.5-3.5z"/><path fill="#242424" d="M16 16a7 7 0 1 0 0-14a7 7 0 0 0 0 14"/><path fill="url(#fluentColorPerson322)" d="M16 16a7 7 0 1 0 0-14a7 7 0 0 0 0 14"/><defs><linearGradient id="fluentColorPerson320" x1="9.707" x2="13.584" y1="19.595" y2="31.977" gradientUnits="userSpaceOnUse"><stop offset=".125" stop-color="#9c6cfe"/><stop offset="1" stop-color="#7a41dc"/></linearGradient><linearGradient id="fluentColorPerson321" x1="16" x2="21.429" y1="16.571" y2="36.857" gradientUnits="userSpaceOnUse"><stop stop-color="#885edb" stop-opacity="0"/><stop offset="1" stop-color="#e362f8"/></linearGradient><linearGradient id="fluentColorPerson322" x1="12.329" x2="19.464" y1="3.861" y2="15.254" gradientUnits="userSpaceOnUse"><stop offset=".125" stop-color="#9c6cfe"/><stop offset="1" stop-color="#7a41dc"/></linearGradient></defs></g></svg>
            </button>

            <!-- Chat Window -->
            <div id="chat-window" class="chat-window">
                <div id="chat-header" class="chat-header">
                    <span>Narada</span>
                    <div id="resize-options">
                        <button id="minimize-btn" class="resize-btn">_</button>
                        <button id="maximize-btn" class="resize-btn">⛶</button>
                        <button id="close-btn" class="resize-btn">✖</button>
                    </div>
                </div>
                <div id="chat-content" class="chat-content">
                    <!-- Messages will appear here -->
                </div>
                <div class="chat-footer">
                    <input type="text" id="user-input" placeholder="Ask me anything..." />
                    <button id="submit-btn">Send</button>
                </div>
                <div id="resize-handle" class="resize-handle"></div> <!-- Handle to resize the window -->
            </div>
    </div>
    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Open/Close chat window
        document.getElementById('copilot-btn').addEventListener('click', function() {
            const chatWindow = document.getElementById('chat-window');
            chatWindow.style.display = chatWindow.style.display === 'none' ? 'flex' : 'none';
        });

        // Minimize the chat window
        document.getElementById('minimize-btn').addEventListener('click', function() {
            const chatWindow = document.getElementById('chat-window');
            chatWindow.style.height = '50px'; // Minimized size
            document.getElementById('chat-content').style.display = 'none'; // Hide messages
            document.getElementById('chat-footer').style.display = 'none'; // Hide footer
            document.getElementById('chat-header').style.fontSize = '12px'; // Smaller text for header
        });


    function handleMouseMove(e) {
        if (isResizing) {
            const chatWindow = document.getElementById('chat-window');
            const newHeight = e.clientY - chatWindow.getBoundingClientRect().top;
            chatWindow.style.height = newHeight + 'px'; // Set new height based on mouse movement
        }
    }

        // Maximize the chat window
        document.getElementById('maximize-btn').addEventListener('click', function() {
            const chatWindow = document.getElementById('chat-window');
            chatWindow.style.height = '400px'; // Reset to original size
            document.getElementById('chat-content').style.display = 'block'; // Show messages
            document.getElementById('chat-footer').style.display = 'flex'; // Show footer
            document.getElementById('chat-header').style.fontSize = '16px'; // Reset header text size
        });

        // Get the chat window and resize elements
        const chatWindow = document.getElementById('chat-window');
        const resizeHandle = document.getElementById('resize-handle');
        const minimizeBtn = document.getElementById('minimize-btn');
        const maximizeBtn = document.getElementById('maximize-btn');
        const closeBtn = document.getElementById('close-btn');

        let isResizing = false;
        let initialWidth = chatWindow.offsetWidth;
        let initialHeight = chatWindow.offsetHeight;
        let initialMouseX = 0;
        let initialMouseY = 0;

        // Function to handle resizing the chat window
        function startResizing(e) {
            isResizing = true;
            initialMouseX = e.clientX;
            initialMouseY = e.clientY;
            document.addEventListener('mousemove', resize);
            document.addEventListener('mouseup', stopResizing);
        }

        // Function to resize the window
        function resize(e) {
            if (isResizing) {
                const widthDiff = e.clientX - initialMouseX;
                const heightDiff = e.clientY - initialMouseY;
                chatWindow.style.width = `${initialWidth + widthDiff}px`;
                chatWindow.style.height = `${initialHeight + heightDiff}px`;
            }
        }

        // Function to stop resizing
        function stopResizing() {
            if (isResizing) {
                initialWidth = chatWindow.offsetWidth;
                initialHeight = chatWindow.offsetHeight;
                isResizing = false;
                document.removeEventListener('mousemove', resize);
                document.removeEventListener('mouseup', stopResizing);
            }
        }

        // Attach resize functionality to the handle
        resizeHandle.addEventListener('mousedown', startResizing);

        // Minimize chat window
        minimizeBtn.addEventListener('click', () => {
            chatWindow.style.height = '50px';
            chatWindow.style.width = '300px';
        });

        // Maximize chat window
        maximizeBtn.addEventListener('click', () => {
            chatWindow.style.height = '400px';
            chatWindow.style.width = '300px';
        });

        // Close chat window
        closeBtn.addEventListener('click', () => {
            chatWindow.style.display = 'none';
        });

            resizeHandle.addEventListener('mousedown', (e) => {
            isResizing = true;
            document.addEventListener('mousemove', handleMouseMove);
            document.addEventListener('mouseup', () => {
                isResizing = false;
                document.removeEventListener('mousemove', handleMouseMove);
            });
        });

            // Close chat window
            document.getElementById('close-btn').addEventListener('click', function() {
                const chatWindow = document.getElementById('chat-window');
                chatWindow.style.display = 'none'; // Hide chat window
            });

        // Handle user input and show message
            document.getElementById('submit-btn').addEventListener('click', function() {
                const userInput = document.getElementById('user-input').value;
                if (userInput.trim()) {
                    const chatContent = document.getElementById('chat-content');
                    const userMessage = document.createElement('div');
                    userMessage.classList.add('message', 'user-message');
                    userMessage.innerText = userInput;
                    chatContent.appendChild(userMessage);

                    // Send user input to Flask backend
                    fetch('/chat', {
                        method: 'POST',
                        body: new URLSearchParams({ user_query: userInput })
                    })
                    .then(response => response.json())
                    .then(data => {
                        const botMessage = document.createElement('div');
                        botMessage.classList.add('message', 'bot-message');
                        botMessage.innerText = data.response;
                        chatContent.appendChild(botMessage);
                    })
                    .catch(error => console.error("Error:", error));

                    document.getElementById('user-input').value = ''; // Clear input field
                    chatContent.scrollTop = chatContent.scrollHeight; // Scroll to the bottom
                }
            });

    </script>

</body>
</html>
